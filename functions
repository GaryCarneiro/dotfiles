# SSHAgent Bash
function sshize() {
    touch ~/.ssh_agent
    ssh-add -l 2>/dev/null | egrep -q ".*"
    if [ $? -eq 0 ] ; then
      echo "Agent already running. Sourcing it in current shell"
      source ~/.ssh_agent
      return 7
    fi
    ssh-agent | head -2 | tee ~/.ssh_agent
    source ~/.ssh_agent
    /bin/echo -e "\nDon't forget to run ssh-add after this\n"
}

# This function cert fetches SSL Certificate on a specified port or defaults the port to 443

function cert() {
    ( [ -z $2 ] ) &&  export port=443  ||  export port=$2  
    openssl s_client -connect $1:$port
}


#This function ta()  does following
# 1. Attaches to ( last?? ) Tmux session if no arguments is given
# 2. Attaches to the same Tmux session if Session exists given an argument
# 3. Creates a Session if not already present given an argument
function ta() {
    if [ -z $1 ] ; then
        echo -e "\nAttaching to last session\n"  
        tmux attach 
    elif [ ! -z $1 ] ; then
        echo -e "Checking if Session exists\n"
        tmux has-session -t $1   && tmux att -t $1

        if [ $? -eq 1 ] ; then
            echo -e  "Session does not exists. Creating one\n" 
            tmux new -s $1 
        fi 
    fi
}

alias tn='ta'


# This functions zaps the host from your ssh KnownHost file
function keydel() {
     [ -z $1 ] && echo  "Please pass some hostname as argument" || ssh-keygen -R $1 
}

